# ADR-001: Слоистая архитектура с инверсией зависимостей
Дата: 2025-01-15
Статус: Accepted

## Context
Сервису требуется гибкая архитектура, позволяющая легко менять компоненты (например, хранилище) без изменения бизнес-логики. Монолитная структура усложняет тестирование и развитие.

## Decision
Применена слоистая архитектура с явным разделением на:
- **Transport layer** (HTTP handlers)
- **Domain layer** (модели и бизнес логика)
- **Storage layer** (репозитории)

Использован принцип инверсии зависимостей - слои зависят от абстракций (интерфейсов), а не от конкретных реализаций.
Слой бизнес логики не зависит ни от чего.

## Alternatives
1. Забыть про четкое разделение на слои, как это обычно бывает

## Consequences
### Плюсы
- Легкая замена компонентов (доказано в текущем ПРе, где заменяется хранилище с imMemory на Postgres без изменений в бизнес логике)
- Упрощенное тестирование (мокирование интерфейсов)
- Четкое разделение ответственности

### Минусы
- Увеличение количества файлов и интерфейсов
- Небольшой overhead на сборке приложения

## Security Impact
- Изоляция бизнес-логики от инфраструктурных concerns
- Упрощение аудита security-контролей
- Минимизация attack surface через четкие границы

## Rollout Plan
1. С самого первого ПРа создается четкое разделение слоев и поддерживается в остальных ПРах

## Links
- отдельный NFR под "качественный код" не заведен
- Реализация: `app/`
